% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/NotSBS.R
\name{NotSBS}
\alias{NotSBS}
\title{Change Point Detection by NotSBS}
\usage{
NotSBS(
  x,
  r = NULL,
  type = NULL,
  m = 3,
  trim,
  threshold = NULL,
  method = c("fixed", "oracle"),
  V.diag = TRUE,
  lrv = TRUE,
  lbd = NULL
)
}
\arguments{
\item{x}{A numeric matrix of dimension \eqn{p \times T}, representing the observed data, where \eqn{p} is the number of series
and \eqn{T} the number of time points.}

\item{type}{An optional numeric vector used to determine the number of change points if \code{m} is not explicitly provided.
If \code{type = 0}, the method assumes no change point.}

\item{m}{An optional integer specifying the expected number of change points (used when \code{method = "oracle"}).
If not supplied, it is inferred from \code{type}.}

\item{trim}{A positive integer specifying the trimming parameter. Only intervals of length greater than \code{2 * trim}
are considered for change point detection.}

\item{threshold}{A numeric value specifying the fixed threshold. Must be provided when \code{method = "fixed"}.}

\item{method}{A character string indicating the selection method. One of \code{"fixed"} or \code{"oracle"}.}

\item{V.diag}{Logical. If \code{TRUE}, only the diagonal of the long-run covariance matrix is used for standardisation.}

\item{lrv}{Logical. If \code{TRUE}, long-run variance is estimated using HAC weights.}

\item{lbd}{Optional numeric value specifying the minimum interval length for seeding.}
}
\value{
A data frame containing the estimated change points and corresponding statistics. The columns include:
\describe{
\item{est.cp}{Estimated location of the change point.}
\item{val}{CUSUM statistic value at the detected point.}
\item{st}{Start index of the interval.}
\item{ed}{End index of the interval.}
\item{trim}{Trimming parameter used.}
}
If \code{method = "oracle"}, additional columns are returned:
\describe{
\item{selected_threshold}{Threshold value that produced exactly \code{m} change points.}
\item{next_highest_threshold}{Next largest threshold.}
\item{no_change_threshold}{Maximum threshold that leads to no change point detection.}
}
}
\description{
This function detects change points in high-dimensional time series data using a Narrowest-over-threshold principle under seeded binary segmentation
(NotSBS) approach based on a standardised CUSUM statistic.
}
\details{
This function operates in two modes:
\itemize{
\item \strong{Fixed}: Retains change points where the CUSUM statistic exceeds a user-specified threshold.
\item \strong{Oracle}: Iteratively searches for the highest threshold yielding exactly \code{m} non-overlapping change points.
}
The underlying CUSUM statistics are computed via \code{\link{cusum.fts}}, and overlap between candidate points is removed
using interval exclusion.
}
\examples{
\dontrun{
# Simulated matrix with time series signals
p <- 100; T <- 400
F_hat <- matrix(rnorm(p * T), nrow = p)

# Fixed threshold method
results_fixed <- NotSBS(x = F_hat, m = 3, type = c(4,1,2), trim = 12,
                        threshold = 5, method = "fixed",
                        V.diag = TRUE, lrv = TRUE, lbd = 20)

# Oracle method
results_oracle <- NotSBS(x = F_hat, m = 3, type = c(4,1,2), trim = 12,
                         method = "oracle",
                         V.diag = TRUE, lrv = TRUE, lbd = 20)
}

}
\seealso{
\code{\link{cusum.fts}}, \code{\link{find_single_cp}}
}
