% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/est_factor_number.R
\name{abc.factor.number}
\alias{abc.factor.number}
\title{Estimate the Number of Factors (Barigozzi, Cho and Trapani (2024))}
\usage{
abc.factor.number(
  x,
  r.max = NULL,
  center = TRUE,
  p.seq = NULL,
  n.seq = NULL,
  do.plot = FALSE
)
}
\arguments{
\item{x}{A matrix of dimension \code{p Ã— n}, where \code{p} is the number of variables and \code{n} the number of time points.}

\item{r.max}{Maximum number of factors to consider. If \code{NULL}, defaults to \code{min(50, floor(sqrt(min(n - 1, p)))}.}

\item{center}{Logical. Should the columns of \code{x} be mean-centred? Default is \code{TRUE}.}

\item{p.seq}{A numeric vector of row (dimension) subsample sizes used for computing the cross-validation error. If \code{NULL}, default values are used.}

\item{n.seq}{A numeric vector of time subsample sizes used for computing the cross-validation error. If \code{NULL}, default values are used.}

\item{do.plot}{Logical. If \code{TRUE}, produces diagnostic plots of estimated rank and variability across constants. Default is \code{FALSE}.}
}
\value{
A list with:
\describe{
\item{r.hat}{A numeric vector of estimated ranks (length 6), corresponding to six different IC variants.}
}
With attributes:
\describe{
\item{Sc}{Matrix of variances of selected ranks across constants.}
\item{const.seq}{The sequence of penalty constants used.}
\item{r.mat}{Array of selected ranks across constants and subsamples.}
}
}
\description{
Approach proposed by Alessi et al.(2010) in combination with the three information criteria of Bai and Ng (2002) procedure
to estimate the number of factors in high-dimensional approximate factor models.
This method is designed to be stable across a range of penalty constants and is suitable for both stationary and change point models.
}
\details{
This function implements the ABC criterion for factor number estimation as proposed in Barigozzi, Cho, and Trapani (2024).
It uses a set of IC-type (information criterion) rules indexed by penalty constants and subsample sizes, selecting
the rank with the smallest variability across constants. The function evaluates both standard and log-transformed ICs.

The output \code{r.hat} contains six values corresponding to the combinations of three penalties (IC1, IC2, IC3)
and two transformation types (raw and log).
}
\examples{
\dontrun{
X <- matrix(rnorm(100 * 200), nrow = 100)
result <- abc.factor.number(X)
result$r.hat
}
}
\references{
Barigozzi, M., Cho, H., & Trapani, L. (2024). \emph{Moving sum procedure for multiple change point detection in large factor models.}
arXiv preprint arXiv:2410.02918.
}
